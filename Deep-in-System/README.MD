# Deep in system

## mettre le clavier en francais :
```
sudo dpkg-reconfigure keyboard-configuration
```
ne pas changer le modele du clavier

ensuite selectionner "French" ppour le pays et la disposition.

### appliqu√© les changement :
```
sudo service keyboard-setup restart
```
puis execut√© :
```
sudo setupcon
```

## üîß Partitionnement manuel du disque pour le projet Deep-in-System

## üéØ Objectif

Cr√©er les partitions suivantes sur un disque de 30 Go, conform√©ment aux sp√©cifications du projet :

| Point de montage | Taille | Syst√®me de fichiers | Remarques              |
|------------------|--------|---------------------|------------------------|
| `/`              | 15‚ÄØGo  | ext4                | Partition principale   |
| `/home`          | 5‚ÄØGo   | ext4                | R√©pertoire utilisateurs |
| `/backup`        | 6‚ÄØGo   | ext4                | Sauvegardes WordPress  |
| swap             | 4‚ÄØGo   | swap                | M√©moire virtuelle      |

---

## üß∞ Outils utilis√©s

- `fdisk` : outil de partitionnement
- `mkfs.ext4` : formatage en ext4
- `mkswap` / `swapon` : configuration de la swap
- `/etc/fstab` : montage automatique au d√©marrage

---

## ‚ö†Ô∏è Pr√©-requis

> ‚ö†Ô∏è Le disque `/dev/sda` sera compl√®tement effac√©. Assurez-vous de travailler sur un disque vierge ou une VM d√©di√©e.

---

## ‚úÖ √âtapes d√©taill√©es

### 1. Identifier le disque

```bash
lsblk
```
V√©rifiez que votre disque est bien /dev/sda.

2. Lancer fdisk
```bash
sudo fdisk /dev/sda
```

3. Cr√©er une nouvelle table de partition GPT

Dans fdisk, tapez :
```bash
g
```
4. Cr√©er les partitions
üîπ / ‚Äì 15 Go
```sh
n          # nouvelle partition
p          # partition principale
[Entr√©e]   # num√©ro par d√©faut
[Entr√©e]   # premier secteur par d√©faut
+15G       # taille
```
üîπ swap ‚Äì 4 Go
```sh
n
p
[Entr√©e]
[Entr√©e]
+4G
t           # changer le type
[Num√©ro]    # num√©ro de la partition swap
8200        # code pour swap
```
5. Enregistrer les modifications
```sh
w
```
6. Formater les partitions
```sh
sudo mkfs.ext4 /dev/sda1   # /
sudo mkfs.ext4 /dev/sda2   # /home
sudo mkfs.ext4 /dev/sda3   # /backup
sudo mkswap /dev/sda4      # swap
```

7. Activer la swap
```sh
sudo swapon /dev/sda4
```
8. Monter les partitions
```sh
sudo mkdir -p /mnt/root
sudo mkdir -p /mnt/root/home
sudo mkdir -p /mnt/root/backup

sudo mount /dev/sda1 /mnt/root
sudo mount /dev/sda2 /mnt/root/home
sudo mount /dev/sda3 /mnt/root/backup
```

9. Configurer le montage automatique

Ajoutez ceci √† /etc/fstab :
```sh
/dev/sda1 /       ext4 defaults 0 1
/dev/sda2 /home   ext4 defaults 0 2
/dev/sda3 /backup ext4 defaults 0 2
/dev/sda4 none    swap sw       0 0
```

## SSH : 
```
sudo nano /etc/ssh/sshd_config
```

Cherche et modifie :
```sh
Port 2222
PermitRootLogin no
```
puis execute :
```sh
sudo systemctl restart ssh
```


pour ce connecter au port :
```sh
ssh -p 2222 potato@127.0.0.1
```

## üî• Firewall (UFW)

Installer et configurer UFW :
```sh
sudo apt install ufw -y
sudo ufw default deny incoming
sudo ufw default allow outgoing

# Autoriser seulement les ports n√©cessaires :
sudo ufw allow 2222/tcp   # SSH
sudo ufw allow 80/tcp     # HTTP (WordPress)
sudo ufw allow 443/tcp    # HTTPS si tu mets SSL

# Activer
sudo ufw enable
sudo ufw status verbose
```
üëâ Justification des ports :

2222 = SSH admin

80 = WordPress site web

443 = si SSL (bonus)

## üë• User Management Part
üëë Utilisateur luffy (sudo + cl√© SSH)

```sh
sudo adduser luffy
sudo usermod -aG sudo luffy
```
Copie ta cl√© publique depuis ton PC vers le serveur :

```sh
ssh-copy-id -i ~/.ssh/id_rsa.pub -p 2222 luffy@ip_serveur
```

ü•ã Utilisateur zoro (non-sudo, mot de passe) :

```sh
sudo adduser zoro
# R√©ponds avec ton mot de passe choisi
```

## üìÇ Services Part ‚Äì FTP (nami)

Installer vsftpd :  
```sh
sudo apt install vsftpd -y
```
Cr√©er l‚Äôutilisateur nami :
```sh
sudo adduser nami
```
Configurer son acc√®s limit√© √† /backup :
```sh
sudo usermod -d /backup nami
```
Rendre /backup en lecture seule pour nami :
```sh
sudo chown root:root /backup
sudo chmod 755 /backup
```

Configurer vsftpd :
```sh
sudo nano /etc/vsftpd.conf
```

V√©rifie :
```sh
anonymous_enable=NO
local_enable=YES
write_enable=NO
chroot_local_user=YES
```
puis :
```sh
sudo systemctl restart vsftpd
```

## üóÑÔ∏è MySQL Server

Installer MySQL :
```sh
sudo apt install mysql-server -y
```

securiser :
```sh
sudo mysql_secure_installation
```
Refuse le remote root login

Pas d‚Äôacc√®s distant

Cr√©er un utilisateur WordPress :

```sql
CREATE DATABASE wordpress;
CREATE USER 'wpuser'@'localhost' IDENTIFIED BY 'TonMotDePasse';
GRANT ALL PRIVILEGES ON wordpress.* TO 'wpuser'@'localhost';
FLUSH PRIVILEGES;
EXIT;
```

Identifiant : wpuser

Password : TonMotDePasse


## üåê Wordpress 

Installer Apache + PHP :
```sh
sudo apt install apache2 php php-mysql libapache2-mod-php unzip wget -y
```

T√©l√©charge Wordpress :
```sh
cd /var/www/html
sudo rm index.html
sudo wget https://wordpress.org/latest.zip
sudo unzip latest.zip
sudo mv wordpress/* .
sudo rm -rf wordpress latest.zip
```

Prot√©ger wp-config.php :

```sh
sudo chown -R www-data:www-data /var/www/html
sudo chmod 640 /var/www/html/wp-config.php
```

Configurer Apache :
```sh
sudo nano /etc/apache2/sites-available/000-default.conf
```

Assure-toi que DocumentRoot /var/www/html est correct.

Puis :
```sh
sudo systemctl restart apache2
```
Acc√®de √† http://potato@localhost/ et finis l‚Äôinstallation.